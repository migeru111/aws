## stepfunctionメモ

### ステートマシン（ワークフロー）
一つの処理単位の大きな塊の一つ。ワークフロー全体を指す<br>
ワークフローの各ステップをstateという<br>
asl(amazon states language)を使用して定義する<br>

### state
ステートマシンの各ステップを指す<br>
ステートには以下2つのステートがある<br>
- フローステート
- タスクステート

#### フローステート
タスクステートを制御するためのステート
下記のようなフローステートがあり、ワークフローを構築できる
- choice state: 条件付きロジックを提供する
- wait state: ワークフローの実行を一時停止する
- map state: データセット内の各項目に対して小ワークフローを実行する
- paralell state: ワークフローに並行処理を追加する

#### タスクステート
別のawsサービスの実行や、API呼び出しなど実際の処理のこと<br>
アクションとも呼ばれる<br>

### execution
ワークフローが実行されたときに作成されるインスタンス<br>

### データの入出力
ワークフローの実行時にjson形式でデータを入力可能<br>
各ステートは、変数とステート出力を使って後段のステートでデータを取り回せる。<br>
変数は後のステートで使用可能。<br>
ステート出力は次のステートの入力になる。<br>

### ステートマシンデータ
ステートマシンで使用されるデータ？  
以下三つがある  
- ステートマシンへの初期入力
- ステート間で渡されるデータ
- ステートマシンからの出力

ステートマシンデータはjsonで表される。

### ステートマシンへの初期入力
ステートマシンを実行する際に初期データを投入することができる。<br>
以下2つの方法がある
- StartExecutionアクションを実行するときに指定する方法
- ステップファンクションコンソールからステートマシンに入力する方法

初期データはStartAtステートに渡される。初期データが入力されていないとき空の{}が渡される。

### ステートマシンからの出力
実行の出力は最後のステートから返され、jsonとして表示される

### ステートへの入力
各ステートへの入力は、前のステートからのJSONテキストで渡される。
startAtステートの場合、ステートマシンに入力されたJSONが渡される。

### 外部連携
stepfunctionは他のawsサービスから呼び出せる。
サービスとしては以下
- lambda
- apiGateway
- eventBridge
- codePipeline
- stepFunction
